# AIdea Lab 고도화 프로젝트 최종 계획서 (최종 수정본)

## 1. 프로젝트 비전 및 목표

*   **비전**: 사용자의 초기 아이디어를 입력받아, 다수의 AI 페르소나가 심층 분석 및 역동적인 토론을 통해 아이디어를 정교하게 다듬고 발전시켜, 구체적인 실행 가능성을 갖춘 혁신적인 결과물로 완성하는 "AI 기반 아이디어 워크숍 플랫폼" 구축.
*   **핵심 목표**:
    1.  **1단계 (챗봇 UI 기반 심층 분석)**: 사용자가 아이디어를 입력하면, 시스템 안내 메시지와 함께 각 AI 페르소나가 순차적으로 전문적인 심층 분석 결과를 챗봇 인터페이스를 통해 제공한다.
    2.  **2단계 (챗봇 UI 기반 상호 토론 및 아이디어 발전)**: 1단계 분석 결과를 바탕으로, AI 페르소나들이 챗봇 인터페이스 내에서 가상 회의 형식의 토론을 통해 아이디어를 비판적으로 검토하고 창의적으로 확장하여 더욱 완성도 높은 아이디어로 발전시킨다.
    3.  **사용자 경험 극대화**: 일관되고 직관적인 챗봇 UI, 명확한 시스템 안내, 능동적인 사용자 참여 옵션을 통해 아이디어 발상 및 구체화 과정을 효과적이고 흥미롭게 지원한다.

## 2. 주요 기능 및 단계별 구현 계획

### Phase 0: 현재 AIdea Lab 기능 (기반)

*   (기존 기능 유지: 사용자 아이디어 입력 UI, AI 페르소나 정의 및 시스템 프롬프트, 오케스트레이터를 통한 순차 호출 및 결과 제시, 최종 요약 보고서 생성 등)

### Phase 1: 1단계 - 챗봇 UI 기반 개별 심층 분석 및 2단계 진입 선택

*   **기능:**
    *   **챗봇 인터페이스 도입 (1단계부터 적용)**:
        *   **시스템 안내 메시지 (LLM 불필요)**: 사용자가 아이디어를 입력하는 순간부터, 미리 정의된 템플릿 기반의 시스템 안내 메시지가 챗봇을 통해 제공된다.
            *   최초 안내: "안녕하세요! AIdea Lab입니다. 분석하고 싶은 아이디어를 입력해주세요."
            *   아이디어 입력 후: "좋습니다. 입력해주신 아이디어를 바탕으로 단계별 분석을 시작하겠습니다. 먼저 마케터의 관점에서 분석한 내용을 전달드릴게요. 잠시만 기다려주세요."
            *   각 페르소나 분석 시작 전 안내: "다음은 비평가의 날카로운 시선으로 아이디어의 잠재적 문제점을 살펴보겠습니다."
        *   **페르소나 분석 결과 제시 (LLM 활용)**: 각 페르소나(마케터 → 비평가 → 엔지니어 순)의 분석 결과가 순차적으로 챗봇 메시지 형태로 사용자에게 전달된다. 결과는 가독성 있는 형식(단락 구분, 핵심 내용 강조 등)으로 제공되며, 분량이 길 경우 요약 메시지와 함께 "더 자세히 보기" 버튼/링크를 통해 확장된 내용을 표시할 수 있는 기능을 고려한다.
    *   **사용자 추가 정보 입력 (선택 사항)**: 아이디어 입력 시, 아이디어의 **핵심 목표, 주요 제약 조건, 중요 가치** 등을 함께 입력받아 `session.state`에 저장하고 모든 단계에서 활용한다.
    *   **1단계 완료 및 2단계 진입 선택 (시스템 안내 메시지 활용)**:
        *   모든 페르소나 분석 완료 후, 시스템이 챗봇 메시지를 통해 안내한다.
            *   안내: "모든 페르소나의 1단계 분석이 완료되었습니다. [1단계 결과 간략 요약 - 이 부분은 각 페르소나 결과의 첫 문장 등 단순 추출 또는 짧은 LLM 요약 활용 가능]. 이 분석 결과를 바탕으로 아이디어를 더욱 발전시키는 2단계 토론을 진행하시겠습니까?"
        *   챗봇 인터페이스 내에 **"2단계 토론 시작하기" 버튼** 및 "여기서 분석 종료하기" 버튼을 제시한다.
        *   2단계 진행 선택 전, 예상되는 토론 방식 및 목표를 간략히 안내하는 시스템 메시지를 추가한다.
*   **ADK 활용**:
    *   1단계의 페르소나별 순차 분석 흐름은 **`SequentialAgent`**를 활용하여 명확하게 구현한다. `sub_agents`로 각 페르소나 `LlmAgent` (마케터, 비평가, 엔지니어)를 순서대로 정의한다.
    *   각 페르소나 `LlmAgent`는 사용자가 입력한 목표/제약/가치 (`{state.user_goal}` 등)를 **1단계용으로 특화된 `instruction`** 내에서 참조하여 분석에 반영한다. (프롬프트는 1단계 심층 분석 보고서 생성에 초점)
    *   각 페르소나의 분석 결과는 `output_key`를 통해 `session.state`에 저장되고 (예: `state.marketer_report_phase1`), 챗봇 UI에 순차적으로 렌더링된다.
*   **UI/UX**: Streamlit의 채팅 컴포넌트(`st.chat_message`, `st.chat_input` 등)를 활용하여 1단계 전체 과정을 챗봇 대화 형식으로 구현한다. AI 응답 시 스트리밍 기능(`st.write_stream`)을 적용하여 사용자 경험을 향상시킨다.

### Phase 2: 2단계 - 실시간 가상 회의 (챗봇 UI 내 토론 지속)

*   **기능:**
    *   **챗봇 인터페이스 내 토론 진행**:
        *   사용자가 "2단계 토론 시작하기"를 선택 시, 기존 챗봇 인터페이스 내에서 **`DiscussionFacilitatorAgent` (토론 촉진자)**가 새로운 참여자로 등장하여 토론 시작을 안내한다 (시스템 메시지 또는 촉진자 첫 발언).
        *   각 페르소나의 발언이 촉진자의 진행에 따라 실시간 채팅처럼 챗봇 UI에 표시된다.
    *   **`DiscussionFacilitatorAgent` (토론 촉진자) 역할 및 로직**:
        *   **ADK 컴포넌트**: **`LlmAgent`**를 기반으로 하며, LLM의 추론을 통해 다음 발언자나 토론 주제를 결정하는 **라우팅(위임) 기능**을 수행한다. (`transfer_to_agent` 또는 유사 메커니즘 활용).
        *   **입력**: 사용자의 초기 아이디어, 1단계 페르소나별 심층 분석 보고서 전체 (`{state.marketer_report_phase1}` 등), 사용자가 입력한 목표/제약 조건, 현재까지의 2단계 토론 기록 (`{state.discussion_history_phase2}`).
        *   **동적 토론 진행 및 기준 설정**:
            *   **아이디어 평가 프레임워크** (예: RICE 핵심 질문) 또는 **1단계에서 지적된 주요 문제점/리스크**를 기반으로 토론 주제를 발의하고 특정 페르소나에게 질문한다.
            *   페르소나 간의 직접적인 동의/반박/질문을 유도한다.
            *   아이디어의 "비판적 검토"와 "창의적 확장"을 균형 있게 조율한다.
        *   **사용자 피드백 통합 (선택적/점진적 구현)**: 촉진자가 특정 시점에 사용자에게 챗봇 메시지를 통해 간략한 의견을 묻고, 사용자 답변을 다음 토론 진행에 반영한다.
    *   **페르소나 에이전트 역할 및 로직 (2단계용)**:
        *   1단계 페르소나 `LlmAgent`와는 **별개의 `instruction` (2단계 토론용 프롬프트)**을 사용하거나, 단일 프롬프트 내 조건부 로직을 통해 2단계 행동 지침을 명확히 따르도록 한다.
        *   **2단계용 프롬프트 핵심 내용**:
            *   현재가 "2단계 토론" 상황임을 명시한다.
            *   1단계 결과물 전체 및 현재 토론 기록, 촉진자 지시를 참조한다.
            *   다른 페르소나 의견을 구체적으로 지칭하며 상호작용 (동의, 반박, 질문)한다.
            *   아이디어를 "발전"시키는 구체적인 제안, 해결책, 창의적 아이디어를 제시한다.
            *   자신의 제안이 사용자 목표/제약 조건과 어떻게 연결되는지 설명한다.
    *   **토론 종료 및 최종 결과 생성**:
        *   촉진자가 설정된 기준(예: 정해진 토론 라운드 수, 주요 쟁점 해결, 사용자 종료 요청 등)에 따라 토론 종료를 선언한다.
        *   `FinalSummaryAgent_Phase2` (별도 `LlmAgent`): 2단계 전체 토론 기록을 바탕으로 "최종 발전된 아이디어 및 실행 계획 보고서"를 생성한다 (1단계 요약 프롬프트와는 다른, 2단계 토론 결과를 반영하는 프롬프트 사용).
        *   챗봇 UI 내에 최종 보고서 메시지(요약 및 상세 내용 링크/확장 가능 형태)로 제시한다.
*   **ADK 활용**:
    *   **토론 촉진자**: 라우팅/위임 기능을 수행하는 핵심 `LlmAgent`.
    *   **페르소나 에이전트**: `LlmAgent`. **2단계 토론에 특화된 별도의 `instruction` 사용 또는 조건부 프롬프트 로직 적용.**
    *   **최종 요약 에이전트**: `LlmAgent`. 2단계 결과 요약에 특화된 `instruction` 사용.
    *   `session.state`를 통해 1단계 결과물, 2단계 토론 기록, 사용자 피드백, 촉진자 지시 등을 공유한다.
*   **UI/UX**: 1단계와 동일한 챗봇 인터페이스에서 토론이 자연스럽게 이어지도록 구현한다. 촉진자와 각 페르소나의 발언 주체가 명확히 구분되도록 UI를 디자인한다.

## 3. 기술 스택 및 아키텍처

*   **프론트엔드**: Streamlit (실시간 채팅 UI 구현: `st.chat_message`, `st.chat_input`, `st.write_stream` 등 적극 활용).
*   **백엔드/AI**: Python, Google ADK, Google Generative AI (Gemini 모델).
*   **시스템 안내 메시지 처리**: Python 내 문자열 템플릿 또는 단순 조건부 로직 (LLM 불필요).
*   **세션 및 상태 관리**: ADK의 `InMemorySessionService` 및 `session.state`.

## 4. 평가 기준 및 성공 지표

*   **아이디어 품질 향상**: 사용자가 1단계 결과 대비 2단계 최종 결과에서 아이디어의 구체성, 실현 가능성, 창의성 등이 향상되었다고 평가하는 비율.
*   **사용자 만족도**: 설문조사 또는 사용성 테스트를 통해 플랫폼의 유용성, 사용 편의성, 토론의 질 등에 대한 만족도 측정.
*   **사용자 참여도**: 2단계 토론 진행률, 사용자 피드백 제공 빈도 등.
*   **기술적 안정성**: 시스템 오류율, 응답 속도 등.

## 5. 리스크 및 완화 방안

*   **챗봇 UI의 자연스러운 대화 흐름**:
    *   리스크: AI 응답 지연, 부자연스러운 대화 전환, 사용자 입력 타이밍 문제.
    *   완화: LLM 응답 속도 최적화 (모델 선택, 프롬프트 최적화). 메시지 스트리밍 적극 활용. 명확한 시스템 안내 메시지. 촉진자 에이전트의 프롬프트 고도화.
*   **컨텍스트 길이 제한 문제 (특히 2단계 토론)**:
    *   리스크: 토론이 길어질 경우 LLM이 전체 맥락을 놓칠 수 있음.
    *   완화: ADK의 컨텍스트 관리 기능 활용. 자체적인 대화 요약 로직 도입 (예: 몇 턴마다 촉진자가 중간 요약 후 다음 주제로 전환). 중요한 정보 위주로 컨텍스트 재구성.
*   **페르소나 프롬프트의 복잡성 관리**: 1단계와 2단계 프롬프트를 명확히 구분하고 (별도 파일 또는 명확한 조건부 로직), 각 단계의 목적에 맞게 최적화한다. 지속적인 테스트와 개선이 필요하다.
*   **사용자 이탈 방지**:
    *   리스크: 1단계 또는 2단계 진행이 너무 길거나 지루하게 느껴질 경우 사용자가 이탈할 수 있음.
    *   완화: 각 단계별 예상 소요 시간 안내 (선택적). 흥미로운 시스템 메시지 및 페르소나 개성 부여. 사용자 피드백을 통한 능동적 참여 유도.

## 6. 향후 확장 가능성

*   다양한 전문 분야의 AI 페르소나 추가 (예: 법률 전문가, 투자자, 사용자 대표 등).
*   특정 산업 또는 도메인별 아이디어 평가 프레임워크 및 관련 페르소나 제공.
*   생성된 아이디어나 토론 내용에 대한 외부 자료 검색 및 통합 기능 (예: 웹 검색 도구 연동).
*   토론 내용 및 최종 아이디어에 대한 시각화 자료 자동 생성 (예: 마인드맵, 강점/약점 차트, 비즈니스 모델 캔버스 초안).
*   사용자 계정 시스템 도입 및 아이디어 저장/관리 기능.
*   팀 협업 기능 (여러 사용자가 하나의 아이디어 워크숍에 참여).
*   유료 기능 도입 시 결제 시스템 연동 (별도 백엔드 API 서버 구축 고려).
*   A2A (Agent-to-Agent) 프로토콜 도입을 통한 외부 AI 에이전트와의 연동 또는 AIdea Lab 페르소나의 외부 서비스화.